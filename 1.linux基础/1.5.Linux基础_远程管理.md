## ä½ ä¸€å®šè¦æƒ³å°½åŠæ³•å–ä»£ä»»ä½•äºº, ç„¶åå†å»æƒ³åŠæ³•ä¸è¢«ä»»ä½•äººå–ä»£

## LinuxåŸºç¡€: è¿œç¨‹ç®¡ç†

-Author: bavdu

-Email: bavduer@gmail.com

-Github: https://github.com/bavdu

---

- sshæœåŠ¡ æ‰§è¡Œè¿œç¨‹å‘½ä»¤/ç§˜é’¥è®¤è¯/scp(10000ğŸŒŸ)
- æ„å»ºFTPæœåŠ¡å™¨
- Nginxéƒ¨ç½²å’ŒåŸºæœ¬ä½¿ç”¨(10000ğŸŒŸ)
- æŸ¥çœ‹ç³»ç»ŸåŠåº”ç”¨æ—¥å¿—(10000ğŸŒŸ)
- dnså®¢æˆ·ç«¯è§£æ
- è®¡åˆ’ä»»åŠ¡(10000ğŸŒŸ)
- æ³¨æ„å¸ƒç½®ä½œä¸šï¼ï¼ï¼

---

##### SSHDæœåŠ¡

```shell
- æ‰§è¡Œè¿œç¨‹å‘½ä»¤ -
[root@linux_basis ~]# hostname
linux_basis
[root@linux_basis ~]# ssh root@10.3.145.74 "hostname"  --hostname bashå‘½ä»¤
The authenticity of host '10.3.145.74 (10.3.145.74)' can't be established.
ECDSA key fingerprint is SHA256:ufeWWYzF3/G8431bb4K2gKoYhxazhY9GDESSbHtaz+A.
ECDSA key fingerprint is MD5:dd:46:67:06:27:1e:45:57:1c:10:7c:a6:e0:e0:58:25.
Are you sure you want to continue connecting (yes/no)? yes ##(è¿™ä¸ªåœ°æ–¹è‡ªå·±è¾“å…¥yes)##
Warning: Permanently added '10.3.145.74' (ECDSA) to the list of known hosts.
root@10.3.145.74's password: â€œâ€â€œ##(è¿™é‡Œè¾“å…¥å¯†ç çš„æ—¶å€™ä¸ä¼šæç¤º,å±äºå¯†æ–‡æ˜¾ç¤º)##â€â€œâ€
Development

- å¯†é’¥è®¤è¯ -
hostA:
[root@linux_basis ~]# ssh-keygen			--äº§ç”Ÿå¯†é’¥å¯¹å„¿
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):	<ç›´æ¥Enterå›è½¦>
Enter passphrase (empty for no passphrase):		<ç›´æ¥Enterå›è½¦>
Enter same passphrase again:		<ç›´æ¥Enterå›è½¦>
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:fYXalO/T3o2gv4sf55dhVHbqQe8IjLFeSM9axNRT8Dw root@linux_basis
The key's randomart image is:
+---[RSA 2048]----+
|           o...o.|
|          o oo+o+|
|         . X+..E=|
|         .++Boo.o|
|        S.o+ooo+ |
|          o. .o+.|
|            o = +|
|           o = =+|
|          oo=oo.+|
+----[SHA256]-----+
[root@linux_basis ~]# ssh-copy-id root@10.3.145.74			--ä¼ é€å…¬é’¥åˆ°æŒ‡å®šçš„æœºå™¨
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@10.3.145.74's password:

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'root@10.3.145.74'"
and check to make sure that only the key(s) you wanted were added.

[root@linux_basis ~]# ssh root@10.3.145.74		--æµ‹è¯•è¿æ¥æ˜¯å¦å…å¯†
Last failed login: Thu Apr  4 17:51:15 CST 2019 from 10.3.145.73 on ssh:notty
There were 4 failed login attempts since the last successful login.
Last login: Tue Apr  2 15:30:25 2019 from 10.3.145.58
[root@Development ~]# exit										--é€€å‡ºç™»å½•è¿œç¨‹çš„è¿›ç¨‹
logout
Connection to 10.3.145.74 closed.
[root@linux_basis ~]#

- è¿œç¨‹ä¼ é€ -
[root@linux_basis /]# tar -czf linux_basis_20190604.tar.gz etc
[root@linux_basis /]# scp -r linux_basis_20190604.tar.gz root@10.3.145.74:/opt/
linux_basis_20190604.tar.gz                          100% 9967KB  29.4MB/s   00:00

-r ä»£è¡¨é€’å½’,åœ¨ä¼ é€ç›®å½•çš„æ—¶å€™å¸¸ç”¨
```



##### æ„å»ºvsftpdæœåŠ¡å™¨

```shell
-ServerPort:
[root@linux_basis ~]# yum -y install vsftpd			--å®‰è£…ftpæœåŠ¡
[root@linux_basis ~]# chmod 755 /var/ftp/
[root@linux_basis ~]# rm -rf /var/ftp/*
[root@linux_basis ~]# systemctl start vsftpd && systemctl enable vsftpd
[root@linux_basis ~]# systemctl stop firewalld && systemctl disable firewalld	--å…³é—­é˜²ç«å¢™
[root@linux_basis ~]# setenforce 0				--å…³é—­selinuxå®‰å…¨æœºåˆ¶

-ClientPort:
[root@linux_basis ~]# yum -y install lftp				--å®‰è£…lftpå·¥å…·
[root@linux_basis ~]# lftp 10.3.145.74
lftp 10.3.145.74:~> ls
-rw-r--r--    1 0        0            1276 Apr 03 06:39 getzodiac.md
drwxr-xr-x    2 0        0            4096 Apr 03 02:46 golang
-rw-r--r--    1 0        0         2566922 Apr 04 08:36 mysql_note.tar.gz
drwxr-xr-x    2 0        0              31 Apr 03 02:48 note
drwxr-xr-x    3 0        0             184 Apr 03 02:47 python
drwxr-xr-x    2 0        0            4096 Apr 03 09:54 videos
lftp 10.3.145.74:/> lcd Download								--åˆ‡æ¢æœ¬åœ°æœºå™¨æ‰€åœ¨ç›®å½•
lftp 10.3.145.74:/> get mysql_note.tar.gz				--ä¸‹è½½æ–‡ä»¶
2566922 bytes transferred
lftp 10.3.145.74:/> mirror python								--ä¸‹è½½ç›®å½•
New: 17 files, 0 symlinks
17 Successfully detected
```



##### Nginxçš„åŸºæœ¬ä½¿ç”¨

```shell
##æ„å»ºLNMPæ¶æ„çš„WebæœåŠ¡å™¨ 
L:linuxæ“ä½œç³»ç»Ÿ
N:nginxæ˜¾ç¤ºç½‘é¡µçš„è¿›ç¨‹
M:mysql/mariadbæ•°æ®åº“
P:python/php/perlç¼–ç¨‹è¯­è¨€

#æ·»åŠ nginxçš„å®‰è£…ä»“åº“
[root@linux_basis ~]# vim /etc/yum.repos.d/nginx.repo
[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key

#å®‰è£…LNMPç¯å¢ƒåŒ…

yum -y install epel-release

[root@linux_basis ~]# yum -y install nginx mariadb-server mariadb php php-gd php-mcrypt php-mbstring php-devel php-mysql php-xml php-fpm

#å¯åŠ¨webã€DBã€phpæœåŠ¡
[root@linux_basis ~]# systemctl enable nginx mariadb php-fpm
[root@linux_basis ~]# systemctl start nginx mariadb php-fpm

#è‡ªå®šä¹‰é…ç½®nginxæœåŠ¡
[root@linux_basis ~]# vim /etc/nginx/conf.d/default.conf
server {
    listen       80;
    server_name  www.zgh1212.com;

    charset koi8-r;
    access_log  /var/log/nginx/zgh1212.access.log  main;

    location / {
        root   /usr/share/nginx/html;
        index  index.php index.html index.htm;
    }

    error_page   404              /404.html;
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    location ~ \.php$ {
        root           /usr/share/nginx/html;
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html/$fastcgi_script_name;
        include        fastcgi_params;
    }
}

##é‡æ–°å¯åŠ¨æœåŠ¡å™¨<ä»¥åä¿®æ”¹åº”ç”¨çš„é…ç½®æ–‡ä»¶åå¿…é¡»è¦è¿›è¡Œè¯­æ³•æ£€æµ‹åŠé‡æ–°å¯åŠ¨>
[root@linux_basis html]# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
[root@linux_basis html]# systemctl restart nginx

##åˆ›å»ºæ•°æ®åº“
	# mysql -uroot -e "create user 'bavduer'@'localhost' identified by '123456';"
	# mysql -uroot -e "create database lnmp;"
	# mysql -uroot -e "grant all privileges on lnmp.* to 'bavduer'@'localhost';"

#æµ‹è¯•lnmpå¯ç”¨æ€§
[root@linux_basis ~]# cd /usr/share/nginx/html/
[root@linux_basis html]# vim index.php
<?php
$link = mysql_connect('localhost', 'bavduer', '123456');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);
?>

##æ‰“å¼€æµè§ˆå™¨åˆ·æ–°é¡µé¢æŸ¥çœ‹æ˜¯å¦æœ‰Successfulå­—æ ·
```



##### ç³»ç»Ÿæ—¥å¿—åŠåº”ç”¨æ—¥å¿—

```shell
##Linuxç³»ç»Ÿä¸­çš„ç³»ç»Ÿæ—¥å¿—åŠåº”ç”¨æ—¥å¿—éƒ½ä¼šå­˜æ”¾åœ¨/var/log/ç›®å½•ä¸­
##åœ¨æ—¥å¿—ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°â€œå„çº§åˆ«é”™è¯¯ä¿¡æ¯â€ã€â€œç³»ç»ŸåŠç¬¬ä¸‰æ–¹åº”ç”¨è¿è¡ŒçŠ¶æ€â€ã€â€œç³»ç»ŸåŠç¬¬ä¸‰æ–¹åº”ç”¨çš„åŠ¨ä½œâ€

é”™è¯¯æ—¥å¿—çº§åˆ«: debug <info <warn <Error <Fatal
                debug æµ‹è¯•:çº§åˆ«æœ€ä½,æœ‰åˆ©äºåœ¨è°ƒè¯•ç¨‹åºæ—¶,æ›´è¯¦ç»†çš„äº†è§£ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
                info  çŠ¶æ€:é‡è¦è¾“å‡ºä¿¡æ¯,ç”¨æ¥åé¦ˆç³»ç»Ÿçš„å½“å‰çŠ¶æ€ç»™ç”¨æˆ·
                warn	è­¦å‘Š:å¯ä¿®å¤,ç³»ç»Ÿå¯ç»§ç»­è¿è¡Œä¸‹å»
                Error	é”™è¯¯:å¯ä¿®å¤,ä½†æ— æ³•ç¡®å®šç³»ç»Ÿä¼šæ­£å¸¸çš„å·¥ä½œä¸‹å»
                Fatal	ç¾éš¾:ç›¸å½“ä¸¥é‡,å¯ä»¥è‚¯å®šè¿™ç§é”™è¯¯å·²ç»æ— æ³•ä¿®å¤,å¹¶ä¸”å¦‚æœç³»ç»Ÿç»§ç»­è¿è¡Œä¸‹å»çš„è¯åæœä¸¥é‡

#æ¡ˆä¾‹01: åŠ¨æ€æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶å°¾éƒ¨(å¯æœ‰æ„çš„åŠ¨æ€æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æ‰€äº§ç”Ÿçš„è®°å½•)
[root@linux_basis ~]# tailf /var/log/messagess

#æ¡ˆä¾‹02: æŸ¥çœ‹ç¬¬ä¸‰æ–¹æœåŠ¡çš„æ—¥å¿—è®°å½•
[root@linux_basis ~]# vim /var/log/nginx/access.log
```



##### DNSè§£æåŸç†

```shell
å› ç‰¹ç½‘ä¸Šä½œä¸ºåŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“,èƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘,è€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„IPæ•°ä¸². é€šè¿‡ä¸»æœºå,æœ€ç»ˆå¾—åˆ°è¯¥ä¸»æœºåå¯¹åº”çš„IPåœ°å€çš„è¿‡ç¨‹å«åšåŸŸåè§£æ.

DNSåè®®è¿è¡Œåœ¨UDPåè®®ä¹‹ä¸Š,ä½¿ç”¨ç«¯å£å·53
```

```shell
[root@linux_basis ~]# dig www.baidu.com

; <<>> DiG 9.10.6 <<>> www.baidu.com			##æ˜¾ç¤ºä¸€äº›æŸ¥è¯¢å‚æ•°å’Œç»Ÿè®¡ä¿¡æ¯.
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 59254
;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:											##DNSç‰ˆæœ¬ä¿¡æ¯åŠæœåŠ¡å·
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:											##æŸ¥è¯¢å†…å®¹, Aæ˜¯Addressçš„ç¼©å†™
;www.baidu.com.			IN	A

;; ANSWER SECTION:												##DNSæœåŠ¡å™¨çš„å›æ‰§åº”ç­”,è¿”å›urlå¯¹åº”çš„IPåœ°å€
www.baidu.com.		1015	IN	CNAME	www.a.shifen.com.			##CNAMEè®°å½•ä¸»è¦ç”¨äºåŸŸåçš„å†…éƒ¨è·³è½¬
www.a.shifen.com.	33	IN	A	14.215.177.38
www.a.shifen.com.	33	IN	A	14.215.177.39

;; Query time: 36 msec										##DNSæœåŠ¡å™¨çš„åŸºæœ¬ä¿¡æ¯
;; SERVER: 114.114.114.114#53(114.114.114.114)
;; WHEN: Fri Apr 19 14:14:34 CST 2019
;; MSG SIZE  rcvd: 101										##å›æ‰§ä¿¡æ¯çš„é•¿åº¦
```

```shell
#åŸŸåçš„æ„æˆ:host.sld.tld.root.
æ ¹åŸŸ(/): root.
é¡¶çº§åŸŸ(tld): com // net // cn
äºŒçº§åŸŸ(sld): baidu.com // sina.com // taobao.com
ä¸»æœºå(host): hostname

[root@linux_basis ~]# dig +trace www.baidu.com 	##åˆ†çº§æŸ¥è¯¢urlå¯¹åº”ä¸»æœº
```

```shell
1ï¼‰é™æ€æ˜ å°„,æ¯å°è®¾å¤‡ä¸Šéƒ½é…ç½®ä¸»æœºåˆ°IPåœ°å€çš„æ˜ å°„,å„è®¾å¤‡ç‹¬ç«‹ç»´æŠ¤è‡ªå·±çš„æ˜ å°„è¡¨,è€Œä¸”åªä¾›æœ¬è®¾å¤‡ä½¿ç”¨;
[root@linux_basis ~]# vim /etc/hosts
192.168.161.234		www.baidu.com

2ï¼‰åŠ¨æ€æ˜ å°„,å»ºç«‹ä¸€å¥—åŸŸåè§£æç³»ç»Ÿ(DNS),åªåœ¨ä¸“é—¨çš„DNSæœåŠ¡å™¨ä¸Šé…ç½®ä¸»æœºåˆ°IPåœ°å€çš„æ˜ å°„,ç½‘ç»œä¸Šéœ€è¦ä½¿ç”¨ä¸»æœºåé€šä¿¡çš„è®¾å¤‡,é¦–å…ˆéœ€è¦åˆ°DNSæœåŠ¡å™¨æŸ¥è¯¢ä¸»æœºæ‰€å¯¹åº”çš„IPåœ°å€

```



##### è®¡åˆ’ä»»åŠ¡

```shell
#è®¡åˆ’ä»»åŠ¡å­˜å‚¨çš„ä½ç½®
[root@JX01 ~]# ls /var/spool/cron/
root jack alice

#ç®¡ç†è®¡åˆ’ä»»åŠ¡çš„å‘½ä»¤
crontab:
  -l     Displays the current crontab on standard output.
  -r     Removes the current crontab.
  -e     Edits  the current crontab using the editor specified.

#è®¡åˆ’ä»»åŠ¡ä¹¦å†™çš„æ ¼å¼
.---------------- minute (0 - 59)
| .-------------- hour (0 - 23)
| | .------------ day of month (1 - 31)
| | | .---------- month (1 - 12) OR jan,feb,mar,apr ...
| | | | .-------- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
| | | | |
* * * * * command/scripts.sh/scripts.py
 
#è®¡åˆ’ä»»åŠ¡æ¡ˆä¾‹                       --åˆ†æ—¶æ—¥æœˆå‘¨
00 02 * * *	ls		//æ¯å¤©2:00æ•´
00 02 1 * *	ls		//æ¯æœˆ1å·2:00æ•´
00 02 14 2 * ls		//æ¯å¹´2æœˆ14å·2:00æ•´
00 02 * * 7 ls		//æ¯å‘¨æ—¥2:00æ•´
00 02 * 6 5 ls		//æ¯å¹´6æœˆçš„å‘¨äº”2:00æ•´ï¼ˆç‰¹æ®Šï¼‰
00 02 14 * 7 ls		//æ¯æœˆ14å·2:00æ•´ æˆ–è€… æ¯å‘¨æ—¥2:00æ•´ï¼Œè¿™ä¸¤ä¸ªæ—¶é—´éƒ½æ‰§è¡Œ
00 02 14 2 7 ls		//æ¯å¹´2æœˆ14å·2:00æ•´ æˆ–è€… æ¯å‘¨æ—¥2:00æ•´ï¼Œè¿™ä¸¤ä¸ªæ—¶é—´éƒ½æ‰§è¡Œ

00 02 * * * ls		//æ¯å¤©2:00æ•´
* 02 * * * ls		//æ¯å¤©2:00ä¸­çš„æ¯ä¸€åˆ†é’Ÿ
* * * * * ls		//æ¯åˆ†é’Ÿæ‰§è¡Œls
* * 14 2 * ls		//2æœˆ14å·çš„æ¯åˆ†é’Ÿ 1440åˆ†é’Ÿ

*/5 * */31 * * ls		//æ¯éš”5åˆ†é’Ÿ
00 02 1,5,8 * * ls	//æ¯æœˆ1,5,8å·çš„2:00æ•´
00 02 1-8 * * ls	//æ¯æœˆ1åˆ°8å·çš„2:00æ•´
00 02 * 1,4,8 * ls  //æ¯å¹´çš„1ï¼Œ4ï¼Œ8æœˆä¸‰ä¸ªæ•´æœˆçš„æ¯å¤©2:00å»æ‰§è¡Œè®¡åˆ’ä»»åŠ¡
00 02 * 1-10 * ls	//1-10æœˆæ¯å¤©çš„2:00æ•´



#æµ‹è¯•è®¡åˆ’ä»»åŠ¡çš„æ‰§è¡Œæ•ˆæœ
1 ç¼–å†™æ‰§è¡Œè„šæœ¬.
vim /crontab.sh 
touch /root/`date +%Y-%m-%d-%H:%M:%S`.txt

2 ç¼–æ’ä»»åŠ¡è®¡åˆ’
[root@localhost ~]# crontab -e
* * 1 1 * bash /crontab.sh

3 ä¿®æ”¹æ—¥æœŸæ—¶é—´ä¸º1æœˆ2æ—¥3ç‚¹4åˆ†
date 01020304
ä¿®æ”¹æ—¶é—´ä¸º1ç‚¹2åˆ†3ç§’
date -s 01:02:03

4 ç›‘æ§å½“å‰ç›®å½•
watch -n 0.5 'ls /root/*.txt'

5 æµ‹è¯•ç›®æ ‡

* * * * 1    //æ¯å‘¨1            æ¯åˆ†é’Ÿä¼šæ‰§è¡Œ
* * * 1 *    //1æœˆæ¯æ—¥          æ¯åˆ†é’Ÿä¼šæ‰§è¡Œ
* * * 1 1    //1æœˆçš„å‘¨1         æ¯åˆ†é’Ÿä¼šæ‰§è¡Œ
* * 1 * *    //æ¯æœˆ1æ—¥          æ¯åˆ†é’Ÿä¼šæ‰§è¡Œ
* * 1 * 1    //æ¯æœˆ1æ—¥å’Œæ¯æœˆå‘¨1  æ¯åˆ†é’Ÿä¼šæ‰§è¡Œ
* * 1 1 *    //1æœˆ1æ—¥           æ¯åˆ†é’Ÿä¼šæ‰§è¡Œ
* * 1 1 1    //1æœˆ1æ—¥å’Œ1æœˆçš„å‘¨1  æ¯åˆ†é’Ÿéƒ½ä¼šæ‰§è¡Œ
```

